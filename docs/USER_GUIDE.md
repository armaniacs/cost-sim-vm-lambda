# ユーザーガイド - AWS Lambda vs VM コスト比較シミュレーター

## 概要

AWS Lambda vs VM コスト比較シミュレーターは、AWS Lambdaと複数のクラウドプロバイダーのVirtual Machine（仮想マシン）のコストを比較し、最適なソリューションを選択するためのWebアプリケーションです。

### 対応プロバイダー
- **AWS**: Lambda, EC2
- **Google Cloud**: Compute Engine
- **Azure**: Virtual Machines
- **Oracle Cloud Infrastructure (OCI)**: Compute instances
- **Sakura Cloud**: 各種インスタンス

## アプリケーションへのアクセス

### ローカル環境
```
http://localhost:5001
```

### 動作環境
- **対応ブラウザ**: Chrome, Firefox, Safari, Edge（最新版）
- **推奨解像度**: 1024x768以上
- **JavaScript**: 有効にする必要があります

## 基本的な使用方法

### 1. Lambda設定

#### Memory Size（メモリサイズ）
- **選択肢**: 128MB, 512MB, 1024MB, 2048MB
- **影響**: メモリサイズが大きいほど、実行速度が向上しますが、コストも増加します
- **推奨**: 処理内容に応じて選択してください

#### Execution Time（実行時間）
- **選択肢**: 1秒, 10秒, 30秒, 60秒
- **デフォルト**: 1秒
- **影響**: 実行時間が長いほど、コストが増加します

#### Execution Frequency（実行頻度）
- **月間実行回数**を選択
- **選択肢**: 
  - 100万回/月（約秒間0.4回）
  - 500万回/月（約秒間1.9回）
  - 1000万回/月（約秒間3.9回）
  - 5000万回/月（約秒間19.3回）
  - 1億回/月（約秒間38.6回）
  - 10億回/月（約秒間386回）

#### AWS Free Tier（AWSフリーティア）
- **チェック時**: 月間100万リクエストと400,000 GB秒の無料枠を適用
- **推奨**: 個人や小規模な利用の場合はチェックしてください

### 2. Virtual Machine設定

各プロバイダーのVMを比較対象として選択できます。デフォルトで全プロバイダーが選択されています。

#### AWS EC2
- **デフォルト**: t3.micro
- **選択肢**: t3.micro〜c5.xlarge
- **特徴**: 豊富なインスタンスタイプ

#### Sakura Cloud
- **デフォルト**: 1 core/1 GB（¥1,595/月）
- **選択肢**: 1〜6コア、1〜12GB
- **特徴**: 日本のデータセンター、円建て料金

#### Google Cloud
- **デフォルト**: e2-micro
- **選択肢**: e2-micro〜c2-standard-4
- **特徴**: 高性能なインスタンス

#### Azure
- **デフォルト**: B1ls（常時無料対象）
- **選択肢**: B1ls〜Standard_D2s_v3
- **特徴**: 幅広いサービス統合

#### Oracle Cloud Infrastructure (OCI)
- **デフォルト**: VM.Standard.E2.1.Micro（常時無料）
- **選択肢**: Micro〜Standard instance
- **特徴**: 高いコストパフォーマンス

### 3. 高度な設定

#### データ転送（Egress）設定

##### Transfer Volume（転送量）
- **選択肢**: 10KB, 100KB, 1MB
- **説明**: 1回の実行あたりのインターネット転送量
- **影響**: 転送量が多いほど、egress費用が増加します

##### Internet Transfer Ratio（インターネット転送割合）
- **設定範囲**: 0% 〜 100%
- **プリセット**: 0%, 10%, 50%, 100%
- **説明**: 
  - **0%**: 完全にプライベートネットワーク内での通信
  - **50%**: 半分がインターネット、半分がプライベート
  - **100%**: 全てインターネット経由の通信

##### Include Free Egress Tier（無料転送枠）
- **デフォルト**: 未選択
- **対象**: AWS, Google Cloud, Azure, OCI
- **無料枠**:
  - AWS/Google Cloud/Azure: 100GB/月
  - OCI: 10TB/月
  - Sakura Cloud: 無制限（無料）

### 4. 通貨・表示設定

#### Exchange Rate（為替レート）
- **デフォルト**: 150 JPY/USD
- **調整可能**: リアルタイムで変更可能
- **影響**: USDベースのプロバイダーの日本円換算に影響

#### Display in JPY（日本円表示）
- **チェック時**: 全ての金額を日本円で表示
- **未チェック時**: USD表示

## 結果の見方

### インタラクティブグラフ

#### グラフの読み方
- **横軸**: 月間実行回数（対数スケール）
- **縦軸**: 月額コスト（USD または JPY）
- **青い実線**: AWS Lambda
- **色付きの破線**: 各VM プロバイダー
- **黄色い縦線**: 参考実行頻度（秒間1〜1000回）
- **紫色い縦線**: ブレークイーブンポイント

#### ブレークイーブンポイント
- LambdaとVMのコストが同じになる実行回数
- この値より少ない実行回数ではLambdaが安価
- この値より多い実行回数ではVMが安価

### Quick Results（クイック結果）
設定した実行頻度での各プロバイダーのコストを表形式で表示します。

### Break-even Analysis（損益分岐点分析）
各VMプロバイダーとLambdaの損益分岐点を詳細に表示します。

### データテーブル
計算に使用されたパラメータと詳細な結果を表示します。

## データエクスポート

### CSV出力
1. **Export CSV**ボタンをクリック
2. 以下の内容がCSVファイルでダウンロードされます：
   - 設定パラメータ
   - 各プロバイダーのコスト詳細
   - ブレークイーブンポイント
   - 実行頻度別コスト比較

### ファイル名
`cost-comparison-YYYY-MM-DD-HHMMSS.csv`

## よくある質問（FAQ）

### Q1: どのプロバイダーを選択すべきですか？
**A**: 以下を考慮してください：
- **実行頻度**: 低頻度ならLambda、高頻度ならVM
- **地理的要件**: 日本国内ならSakura Cloud
- **既存環境**: 使用中のクラウドプロバイダー
- **予算**: 最小構成から始めたい場合

### Q2: フリーティアは考慮すべきですか？
**A**: 以下の場合は有効にしてください：
- **AWS**: 月間100万リクエスト以下
- **個人利用**: 開発・テスト目的
- **小規模運用**: スタートアップや小規模サービス

### Q3: 実行時間はどう決めればよいですか？
**A**: 実際の処理時間を測定してください：
- **データ処理**: 通常1-10秒
- **API呼び出し**: 通常1-3秒
- **画像処理**: 5-30秒
- **ML推論**: 3-15秒

### Q4: インターネット転送割合の設定方法は？
**A**: 用途に応じて設定してください：
- **API Gateway + RDS**: 10-30%（レスポンスのみ外部）
- **Webスクレイピング**: 80-100%（全て外部通信）
- **バッチ処理**: 0-20%（結果保存のみ外部）
- **リアルタイム通信**: 90-100%（ほぼ全て外部）

### Q5: 結果が実際のコストと異なる場合は？
**A**: 以下を確認してください：
- **実際の実行時間**: 設定値と実測値の差
- **メモリ使用量**: 実際の必要メモリ
- **ネットワーク使用量**: 実際の転送量
- **他のAWSサービス**: API Gateway、RDS等の費用

### Q6: 複数のLambda関数がある場合は？
**A**: 各関数ごとに計算して合算してください：
- 実行頻度と処理時間が異なる場合
- メモリ要件が大きく異なる場合
- 用途が異なる関数の場合

## トラブルシューティング

### グラフが表示されない
1. **ブラウザの更新**: F5キーでページを更新
2. **JavaScript確認**: 開発者ツール（F12）でエラーを確認
3. **必須項目確認**: 全ての設定項目が入力されているか確認

### 計算結果がおかしい
1. **設定値確認**: 各パラメータが適切に設定されているか
2. **為替レート確認**: 最新のレートに更新
3. **フリーティア確認**: 適用条件に合致しているか

### CSVがダウンロードできない
1. **ブラウザ設定**: ダウンロード許可設定を確認
2. **ポップアップブロック**: 一時的に無効化
3. **ブラウザ再起動**: キャッシュクリア後に再試行

### 表示が崩れる
1. **ブラウザの互換性**: 推奨ブラウザを使用
2. **画面解像度**: 1024x768以上に設定
3. **ズームレベル**: 100%に設定

## サポート・お問い合わせ

### バグ報告
- GitHub Issues にて報告してください
- 再現手順と環境情報を含めてください

### 機能要望
- GitHub Issues にて要望を投稿してください
- 具体的な用途と期待する動作を記載してください

### 技術サポート
- 基本的な使用方法は本ガイドを参照
- 高度な技術的質問は開発チームまで

---

**最終更新**: 2025年1月18日  
**バージョン**: 1.0  
**対応アプリケーションバージョン**: 1.0.0